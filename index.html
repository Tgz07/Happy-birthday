<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ch√∫c M·ª´ng Sinh Nh·∫≠t!</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="falling-text"></div>
    <div class="container redesigned horizontal-form">
      <div class="birthday-header">
        <span class="birthday-icon">üéÇ</span>
        <h1>Ch√∫c M·ª´ng Sinh Nh·∫≠t!</h1>
      </div>
      <div class="horizontal-content">
        <div class="upload-section">
          <label for="imgUpload"
            ><span class="upload-icon">üñºÔ∏è</span> ·∫¢nh sinh nh·∫≠t:</label
          >
          <input type="file" id="imgUpload" accept="image/*" />
          <img id="birthdayImg" class="birthday-img" />
        </div>
        <div class="upload-section">
          <label for="audioUpload"
            ><span class="upload-icon">üéµ</span> Nh·∫°c n·ªÅn:</label
          >
          <input type="file" id="audioUpload" accept="audio/*" />
          <audio id="birthdayAudio" controls class="birthday-audio"></audio>
        </div>
        <div class="confetti-section">
          <button class="confetti-btn" onclick="showConfetti()">
            üéâ Nh·∫≠n ph√°o hoa
          </button>
          <canvas id="confetti"></canvas>
        </div>
      </div>
    </div>
    <script src="script.js"></script>
    <script>
      // Danh s√°ch c√°c l·ªùi ch√∫c ng·∫´u nhi√™n
      const wishes = [
        "Ch√∫c m·ª´ng sinh nh·∫≠t!",
        "Vui v·∫ª, h·∫°nh ph√∫c nh√©!",
        "Th√†nh c√¥ng v√† may m·∫Øn!",
        "Lu√¥n c∆∞·ªùi th·∫≠t t∆∞∆°i!",
        "M√£i y√™u ƒë·ªùi!",
        "S·ª©c kh·ªèe d·ªìi d√†o!",
        "∆Ø·ªõc g√¨ ƒë∆∞·ª£c n·∫•y!",
        "B√™n gia ƒë√¨nh v√† b·∫°n b√®!",
        "Tu·ªïi m·ªõi th·∫≠t tuy·ªát!",
        "Happy Birthday!",
      ];

      function getRandomColor() {
        const colors = [
          "#ff4e50",
          "#f9d423",
          "#00c3ff",
          "#ff00cc",
          "#00ff99",
          "#ffcc00",
          "#ff6600",
          "#00ffcc",
          "#cc00ff",
          "#ff0066",
        ];
        return colors[Math.floor(Math.random() * colors.length)];
      }

      // Scrambling Text Effect cho background
      function scrambleText(text) {
        const chars =
          "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";
        let scrambled = "";
        for (let i = 0; i < text.length; i++) {
          scrambled +=
            Math.random() > 0.5
              ? chars[Math.floor(Math.random() * chars.length)]
              : text[i];
        }
        return scrambled;
      }

      function createScramblingFallingText() {
        const text = wishes[Math.floor(Math.random() * wishes.length)];
        const container = document.getElementById("falling-text");
        const div = document.createElement("div");
        div.className = "vertical-falling";
        // Random v·ªã tr√≠ ngang v√† chi·ªÅu s√¢u (scale, blur, opacity)
        const left = Math.random() * 100;
        const width = Math.random() * 2 + 1; // 1-3em
        const scale = Math.random() * 0.7 + 0.7; // 0.7-1.4
        const blur = Math.random() * 2.5; // 0-2.5px
        const opacity = Math.random() * 0.5 + 0.5; // 0.5-1
        div.style.left = left + "vw";
        div.style.width = width + "em";
        div.style.transform = `scale(${scale})`;
        div.style.filter = `blur(${blur}px)`;
        div.style.opacity = opacity;
        div.style.textShadow = `0 0 16px ${getRandomColor()}, 0 0 32px #fff2`;
        // Kh√¥ng ƒë√® l√™n h·ªôp ch√≠nh
        const topArea = Math.random() * 80; // 0-80vh
        div.style.top = topArea + "vh";
        // T·∫°o t·ª´ng k√Ω t·ª± th√†nh 1 span d·ªçc v·ªõi scrambling effect v√† hi·ªáu ·ª©ng r∆°i
        for (let i = 0; i < text.length; i++) {
          const charSpan = document.createElement("span");
          charSpan.textContent = scrambleText(text[i]);
          charSpan.style.display = "block";
          charSpan.style.color = getRandomColor();
          charSpan.style.textShadow = `0 0 8px ${getRandomColor()}, 0 0 16px #fff2`;
          charSpan.style.opacity = opacity;
          // Hi·ªáu ·ª©ng r∆°i cho t·ª´ng k√Ω t·ª±
          charSpan.animate(
            [
              { transform: "translateY(-60px)", opacity: 0 },
              {
                transform: `translateY(${Math.random() * 350 + 50}px)`,
                opacity: 1,
              },
              {
                transform: `translateY(${Math.random() * 400 + 100}px)`,
                opacity: 0,
              },
            ],
            {
              duration: 4000,
              easing: "linear",
              fill: "forwards",
            }
          );
          div.appendChild(charSpan);
        }
        container.appendChild(div);
        // Hi·ªáu ·ª©ng scrambling li√™n t·ª•c
        let scrambleInterval = setInterval(() => {
          for (let i = 0; i < div.children.length; i++) {
            div.children[i].textContent = scrambleText(text[i]);
          }
        }, 80);
        setTimeout(() => {
          clearInterval(scrambleInterval);
          div.remove();
        }, 4000);
      }

      setInterval(createScramblingFallingText, 700);
    </script>
  </body>
</html>
